<!doctype html>
<!--* FileScope: Standalone pixel-view-based file analyser and dissector by techn0z0ne (somedudefrom2021@gmail.com), 2025

Non-military license for peaceful projects (based on BSD 3-Clause)

Copyright (c) 2025 techn0z0ne (somedudefrom2021@gmail.com). All Rights Reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted only when the following conditions are met:

1. Redistributions of source code or binary forms containing or based on source
   code must reproduce the above copyright notice, this list of conditions and
   the following disclaimer in the documentation and/or other materials
   provided with the distribution.

2. Neither the name of the copyright holder nor the names of its contributors
   may be used to endorse or promote products derived from this software without
   specific prior written permission.

3. The source code or its derivatives in any form of delivery,
   including binary/executable, linkable, pluggable or online form, is not licensed
   and is not intended for use in the design, construction, operation or maintenance
   of any military facilities or systems, as well as for military research, or for
   the development of military systems or for their production, as well as weapons,
   systems designed for intentional harming or depriving the life or business,
   including any software used to support military facilities or military systems,
   or used for military or harming purposes.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

-->

<html>
<head>
<meta charset="utf-8">
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; connect-src 'self'; font-src 'self' data:;">
<title>FileScope: File RAW Viewer</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  background: #111;
  color: #eee;
  font-family: system-ui, -apple-system, sans-serif;
  overflow: hidden;
  height: 100vh;
  display: flex;
  flex-direction: column;
}
#dropzone {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0, 0, 0, 0.95);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 32px;
  z-index: 1000;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.2s;
}
#dropzone.active {
  opacity: 1;
  pointer-events: all;
}
#status {
  background: #0f0f0f;
  overflow: auto;
  padding: 8px;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
  font-size: 11px;
  line-height: 1.4;
  position: relative;
  flex-shrink: 0;
  flex: 1;
}
#statusContent {
  flex: 1;
  overflow: auto;
  position: relative;
}
#hexCrosshairH, #hexCrosshairV {
  position: absolute;
  background: rgba(128, 128, 128, 0.5);
  pointer-events: none;
  display: none;
  z-index: 10;
}
#hexCrosshairH {
  height: 1em;
  left: 0;
  right: 0;
}
#hexCrosshairV {
  width: 2ch;
  top: 0;
  bottom: 0;
}
#main {
  flex: 1;
  display: grid;
  grid-template-columns: 2fr 1fr;
  overflow: hidden;
  position: relative;
}
#canvasWrap {
  overflow: auto;
  background: #0a0a0a;
  position: relative;
}
#rightPanel {
  display: flex;
  flex-direction: column;
  overflow: hidden;
  border-left: 1px solid #444;
}
#canvas {
  display: block;
  image-rendering: pixelated;
  image-rendering: crisp-edges;
  cursor: crosshair;
  background: #000;
}
#pixelMarker {
  position: absolute;
  width: 1px;
  height: 1px;
  background: #ff0000;
  pointer-events: none;
  display: none;
  box-shadow: 0 0 3px #00ffff, 0 0 6px #00ffff;
  animation: blink 0.8s infinite;
  transform-origin: center;
  z-index: 6;
}
@keyframes blink {
  0%, 49% { opacity: 1; }
  50%, 100% { opacity: 0.2; }
}
@keyframes sectionBlink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}
#crosshairH, #crosshairV {
  position: absolute;
  background: rgba(250, 128, 128, 0.7);
  pointer-events: none;
  display: none;
  z-index: 10;
}
#controls {
  background: #1a1a1a;
  border-bottom: 1px solid #444;
  padding: 12px;
  overflow-x: auto;
  flex-shrink: 0;
  display: grid;
  grid-template-columns: auto auto auto auto 1fr auto auto;
  gap: 8px 16px;
  align-items: center;
}
#controls label {
  display: inline-block;
  font-size: 11px;
  color: #aaa;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  white-space: nowrap;
}
#controls input[type="number"],
#controls select {
  background: #2a2a2a;
  border: 1px solid #444;
  color: #eee;
  padding: 6px 8px;
  border-radius: 3px;
  font-size: 12px;
}
#controls button {
  background: #0066cc;
  border: none;
  color: #fff;
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  transition: background 0.2s;
}
#controls button:hover {
  background: #0052a3;
}
#controls button:active {
  background: #004080;
}
.stat {
  font-size: 11px;
  color: #888;
  margin-bottom: 8px;
  padding-bottom: 8px;
  border-bottom: 1px solid #333;
}
#textPreview {
  background: #1a1a1a;
  border-top: 1px solid #444;
  padding: 8px 12px;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
  font-size: 11px;
  overflow-x: auto;
  overflow-y: hidden;
  white-space: pre;
  flex-shrink: 0;
  display: none;
  max-height: calc(3 * 1.2em);
  line-height: 1.2;
}
#elfInfo {
  background: #0f0f0f;
  border-top: 1px solid #444;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
  font-size: 11px;
  flex-shrink: 0;
  display: none;
  max-height: 350px;
  line-height: 1.4;
  min-width: 0;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}
#elfInfo .elf-header-wrapper {
  padding: 8px 12px 0 12px;
  flex-shrink: 0;
}
#elfInfo .elf-sections-wrapper {
  overflow-y: auto;
  overflow-x: auto;
  flex: 1;
  padding: 0 12px 12px 12px;
}
#elfInfo h3 {
  margin: 0 0 8px 0;
  font-size: 12px;
  color: #00aaff;
  font-weight: bold;
}
#elfInfo .elf-header-info {
  margin-bottom: 6px;
  padding-bottom: 6px;
  border-bottom: 1px solid #333;
  color: #aaa;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2px 16px;
  font-size: 10px;
}
#elfInfo .elf-header-info span {
  white-space: nowrap;
}
#elfInfo .elf-section-header {
  margin-top: 4px;
  margin-bottom: 4px;
}
#elfInfo .elf-section {
  display: grid;
  grid-template-columns: 20px 90px 80px 80px 90px 1fr;
  gap: 4px;
  padding: 4px 0;
  border-bottom: 1px solid #2a2a2a;
  color: #ccc;
  min-width: 450px;
}
#elfInfo .elf-section:hover {
  background: #252525;
}
#elfInfo .elf-section.selected {
  background: #2a4a5a;
  outline: 1px solid #00aaff;
}
#elfInfo .elf-section-header {
  font-weight: bold;
  color: #888;
  border-bottom: 1px solid #444;
  padding-bottom: 4px;
  margin-bottom: 4px;
}
#elfInfo .elf-section {
  cursor: pointer;
}
#elfInfo .color-indicator {
  width: 12px;
  height: 12px;
  border-radius: 2px;
  display: inline-block;
  margin-right: 4px;
}
</style>
</head>
<body>

<div id="dropzone" role="region" aria-label="File drop zone">
  Drop file here to visualize
</div>

<div style="grid-column: 1 / -1; display: flex; gap: 16px; margin-top: 4px; flex-wrap: wrap;">
  <div class="stat" style="border: none; margin: 0; padding: 0;">
    <strong>File:</strong> <span id="fileName">—</span>
  </div>
  <div class="stat" style="border: none; margin: 0; padding: 0;">
    <strong>Size:</strong> <span id="fileSize">—</span>
  </div>
  <div class="stat" style="border: none; margin: 0; padding: 0;">
    <strong>Chars:</strong> <span id="charCount">—</span>
  </div>
  <div class="stat" style="border: none; margin: 0; padding: 0;">
    <strong>NewLines:</strong> <span id="lineCount">—</span>
  </div>
  <div class="stat" style="border: none; margin: 0; padding: 0;">
    <strong>Render:</strong> <span id="renderTime">—</span>
  </div>
</div>

<div id="securityAlert" style="background: #ff0000; color: #fff; padding: 10px 12px; text-align: center; font-size: 13px; font-weight: bold; display: none; border-bottom: 2px solid #cc0000;">
  <span id="securityAlertText"></span>
</div>

<div id="welcomeMessage" style="background: #1a1a1a; border-bottom: 1px solid #444; padding: 10px 12px; text-align: center; color: #888; font-size: 13px; display: flex; justify-content: space-between; align-items: center;">
  <span style="flex: 1;"></span>
  <span style="flex: 1;">Drop file to page • Click on pixel to inspect</span>
  <span style="flex: 1; text-align: right; font-size: 11px; color: #666;">
    <a href="https://github.com/techn0z0ne/FileScope" target="_blank" style="color: #0066cc; text-decoration: none;">github.com/techn0z0ne/FileScope</a>
  </span>
</div>

<div id="controls">
  <div style="display: flex; flex-direction: column; gap: 4px;">
    <label for="widthInput">Canvas Width</label>
    <input type="number" id="widthInput" value="1024" min="1" max="64000" step="1" style="width: 80px;" aria-label="Canvas width in pixels">
  </div>
  
  <div style="display: flex; flex-direction: column; gap: 4px;">
    <label for="colorMode">Color Mode</label>
    <select id="colorMode" style="width: 170px;" aria-label="Color rendering mode">
      <option value="hsv" selected>HSV (Hue + Brightness)</option>
      <option value="gray">Grayscale</option>
    </select>
  </div>
  
  <div style="display: flex; flex-direction: column; gap: 4px;">
    <label>Zoom Settings</label>
    <div style="display: flex; align-items: center; gap: 8px;">
      <span style="font-size: 10px; color: #888; white-space: nowrap;">Zoom</span>
      <input type="range" id="zoomLevel" min="0.1" max="30" step="0.1" value="5.0" style="width: 100px;" aria-label="Zoom level">
      <span style="font-size: 10px; color: #666; white-space: nowrap;"><span id="zoomLevelValue">5.0</span>×</span>
    </div>
    <div style="display: flex; align-items: center; gap: 8px;">
      <span style="font-size: 10px; color: #888; white-space: nowrap;">Sens</span>
      <input type="range" id="zoomSensitivity" min="0.1" max="30" step="0.1" value="10" style="width: 100px;" aria-label="Zoom sensitivity">
      <span style="font-size: 10px; color: #666; white-space: nowrap;"><span id="zoomSensValue">10.0</span>×</span>
    </div>
  </div>
  
  <div style="display: flex; flex-direction: column; gap: 8px;">
    <label style="cursor: pointer; text-transform: none; font-size: 12px;">
      <input type="checkbox" id="hexViewOverride" style="margin-right: 4px;" aria-label="Force hex view mode">Force Hex View
    </label>
    
    <label style="cursor: pointer; text-transform: none; font-size: 12px;">
      <input type="checkbox" id="showCrosshair" checked style="margin-right: 4px;" aria-label="Show crosshair overlay">Show Crosshair
    </label>
  </div>
  
  <div style="display: flex; flex-direction: column; gap: 8px;">
    <label id="highlightSectionsLabel" style="cursor: pointer; text-transform: none; font-size: 12px; display: none;">
      <input type="checkbox" id="highlightSections" checked style="margin-right: 4px;" aria-label="Highlight ELF sections">Highlight Sections
    </label>
    
    <label id="blinkSectionsLabel" style="cursor: pointer; text-transform: none; font-size: 12px; display: none;">
      <input type="checkbox" id="blinkSections" style="margin-right: 4px;" aria-label="Blink ELF section borders">Blink Sections
    </label>
  </div>
  
  <div style="font-family: monospace; font-size: 10px; line-height: 1.3; display: flex; flex-direction: column; gap: 2px; grid-column: 5; align-self: center; justify-self: end; margin-right: 16px;">
    <strong style="color: #aaa;">Debug:</strong>
    <span id="debugInfo">—</span>
  </div>
  
  <div style="font-family: monospace; font-size: 10px; line-height: 1.3; display: flex; flex-direction: column; gap: 2px; grid-column: 6; grid-row: 2; align-self: center; justify-self: start; margin-left: 8px; color: #888;">
    <span id="storageInfo">—</span>
  </div>
  
  <button id="saveButton" style="grid-column: 6; grid-row: 1;" aria-label="Save rendered canvas as PNG image">Save Image</button>
  
  <label style="cursor: pointer; text-transform: none; font-size: 12px; grid-column: 7; grid-row: 2; align-self: center; justify-self: start; margin-left: 8px;">
    <input type="checkbox" id="autoClearAlert" checked style="margin-right: 4px;" aria-label="Auto-clear security alerts">Auto-Clear Alerts
  </label>
  
  <button id="clearStorageBtn" style="grid-column: 7; grid-row: 1; background: #cc3300;" aria-label="Clear saved file from browser storage">Clear Storage</button>
</div>

<div id="main">
  <div id="canvasWrap">
    <canvas id="canvas"></canvas>
    <div id="pixelMarker"></div>
    <div id="crosshairH"></div>
    <div id="crosshairV"></div>
  </div>

  <div id="rightPanel">
    <div id="status">
      <div id="statusContent"></div>
      <div id="hexCrosshairH"></div>
      <div id="hexCrosshairV"></div>
    </div>
    
    <div id="elfInfo"></div>
  </div>
</div>

<div id="textPreview"></div>

<script src="FiloScope.js"></script>
